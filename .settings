#!/usr/bin/env bash
export EDITOR='vim'

# GDB debug support
# https://debuginfod.opensuse.org/
export DEBUGINFOD_URLS="https://debuginfod.opensuse.org/"

# Detect and greet remote users
if [[ -n $SSH_CONNECTION ]]; then
	>&2 echo "You are now on `hostname`"
	if [ -t 1 ]; then exec fish; fi
fi

# Legacy bash setup
. ~/.aliases

###
# $PATH setup
#
# IMPORTANT: if you are making
# changes, make sure to call
# the `_setup_fish` function
# from Bash. This will port the
# settings over to the Fish
# global config.
###

P0="./bin"
P1="./node_modules/.bin"
P2="$HOME/.cargo/bin"
P3="$HOME/.local/bin"
P4="$HOME/.gem/ruby/2.4.0/bin"
P5="$HOME/go/bin"
P6="$HOME/.deno/bin"
# todo: move wasm projects out of Dev
P7="$HOME/Dev/emsdk/upstream/emscripten"
P8="$HOME/Dev/wasm-qt/src/bin"

USER_PATHS="$P0:$P1:$P2:$P3:$P4:$P5:$P6:$P7:$P8"

# Teach MacOS about the home bin folder
os=`uname -s`
if [[ "$os" == "Darwin" ]]; then
	USER_PATHS="$USER_PATHS:$HOME/bin"
fi

## inject additional dirs
export PATH="$USER_PATHS:$PATH"

function _setup_fish() {
	fish -c "set -U fish_user_paths; set -U fish_user_paths $USER_PATHS \$fish_user_paths"
}

export -f _setup_fish

